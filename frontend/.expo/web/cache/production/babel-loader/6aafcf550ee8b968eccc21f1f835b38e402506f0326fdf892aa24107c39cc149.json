{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Picker from\"react-native-web/dist/exports/Picker\";import Button from\"react-native-web/dist/exports/Button\";import React,{useEffect,useState}from\"react\";import{useRoute}from\"@react-navigation/native\";import{useUser}from\"../../contexts/UserContext\";import MovimientosServices from\"../../services/MovimientosServices\";import{API_BASE_URL,API_ROUTES}from\"../../constants/API\";import axios from\"axios\";import{toast}from\"react-toastify\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DetalleReservaScreen=function DetalleReservaScreen(){var route=useRoute();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),detalleReserva=_useState2[0],setDetalleReserva=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),ejemplaresDisponibles=_useState4[0],setEjemplaresDisponibles=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),selectedEjemplar=_useState6[0],setSelectedEjemplar=_useState6[1];var reservaId=route.params.reservaId;var _useUser=useUser(),userInfo=_useUser.userInfo;var accessToken=userInfo.access_token;useEffect(function(){var fetchDetalleReserva=function(){var _ref=_asyncToGenerator(function*(){try{var response=yield axios.get(`${API_BASE_URL}${API_ROUTES.RESERVAS}${reservaId}/entregar_ejemplar/`,{headers:{Authorization:`Bearer ${accessToken}`}});setDetalleReserva(response.data.reserva);setEjemplaresDisponibles(response.data.ejemplares_disponibles);console.log(response.data);console.log(response.data.reserva);console.log(response.data.ejemplares_disponibles);}catch(error){console.error(\"Error al obtener los datos de la reserva\");}});return function fetchDetalleReserva(){return _ref.apply(this,arguments);};}();fetchDetalleReserva();},[reservaId,accessToken]);var handleEntregarEjemplar=function(){var _ref2=_asyncToGenerator(function*(){try{var access_token=userInfo.access_token;yield MovimientosServices.entregarEjemplarReserva(access_token,reservaId);toast.success(\"El prestamo ha sido creado exitosamente\");}catch(error){console.error(\"Error al entregar el ejemplar\");}});return function handleEntregarEjemplar(){return _ref2.apply(this,arguments);};}();return _jsx(View,{children:detalleReserva?_jsxs(View,{children:[_jsx(Text,{children:\"Detalles de la reserva\"}),_jsxs(Text,{children:[\"Solicitante:\",detalleReserva.owner]}),_jsxs(Text,{children:[\"Material: \",detalleReserva.material]}),_jsxs(Text,{children:[\"Finalizacion: \",detalleReserva.fecha_fin]}),_jsx(Text,{children:\"Selecciona un ejemplar: \"}),_jsx(Picker,{selectedValue:selectedEjemplar,onvalueChange:function onvalueChange(itemValue){return setSelectedEjemplar(itemValue);},children:ejemplaresDisponibles.map(function(ejemplar,index){return _jsx(Picker.Item,{label:`ID: ${ejemplar.id}, Estado: ${ejemplar.estado}`,value:ejemplar.id},index);})}),_jsx(Button,{title:\"Entregar ejemplar\",onPress:handleEntregarEjemplar})]}):_jsx(Text,{children:\"Cargando reserva...\"})});};export default DetalleReservaScreen;","map":{"version":3,"names":["React","useEffect","useState","useRoute","useUser","MovimientosServices","API_BASE_URL","API_ROUTES","axios","toast","jsx","_jsx","jsxs","_jsxs","DetalleReservaScreen","route","_useState","_useState2","_slicedToArray","detalleReserva","setDetalleReserva","_useState3","_useState4","ejemplaresDisponibles","setEjemplaresDisponibles","_useState5","_useState6","selectedEjemplar","setSelectedEjemplar","reservaId","params","_useUser","userInfo","accessToken","access_token","fetchDetalleReserva","_ref","_asyncToGenerator","response","get","RESERVAS","headers","Authorization","data","reserva","ejemplares_disponibles","console","log","error","apply","arguments","handleEntregarEjemplar","_ref2","entregarEjemplarReserva","success","View","children","Text","owner","material","fecha_fin","Picker","selectedValue","onvalueChange","itemValue","map","ejemplar","index","Item","label","id","estado","value","Button","title","onPress"],"sources":["/home/pytufo/Escritorio/Tesis-master/frontend/screens/movimientos/DetalleReservaScreen.js"],"sourcesContent":["import { View, Text, Picker, Button } from \"react-native\";\nimport React, { useEffect, useState } from \"react\";\nimport { useRoute } from \"@react-navigation/native\";\nimport { useUser } from \"../../contexts/UserContext\";\nimport MovimientosServices from \"../../services/MovimientosServices\";\nimport { API_BASE_URL, API_ROUTES } from \"../../constants/API\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\n\nconst DetalleReservaScreen = () => {\n  const route = useRoute();\n  const [detalleReserva, setDetalleReserva] = useState(null);\n  const [ejemplaresDisponibles, setEjemplaresDisponibles] = useState([]);\n  const [selectedEjemplar, setSelectedEjemplar] = useState(\"\");\n  const { reservaId } = route.params;\n\n  const { userInfo } = useUser();\n  const accessToken = userInfo.access_token;\n  useEffect(() => {\n    const fetchDetalleReserva = async () => {\n      try {\n        const response = await axios.get(\n          `${API_BASE_URL}${API_ROUTES.RESERVAS}${reservaId}/entregar_ejemplar/`,\n          {\n            headers: {\n              Authorization: `Bearer ${accessToken}`,\n            },\n          }\n        );\n        setDetalleReserva(response.data.reserva);\n        setEjemplaresDisponibles(response.data.ejemplares_disponibles);\n        console.log(response.data);\n        console.log(response.data.reserva);\n        console.log(response.data.ejemplares_disponibles);\n      } catch (error) {\n        console.error(\"Error al obtener los datos de la reserva\");\n      }\n    };\n\n    fetchDetalleReserva();\n  }, [reservaId, accessToken]);\n\n  const handleEntregarEjemplar = async () => {\n    try {\n      const access_token = userInfo.access_token;\n      await MovimientosServices.entregarEjemplarReserva(\n        access_token,\n        reservaId,\n      );\n      toast.success(\"El prestamo ha sido creado exitosamente\");\n    } catch (error) {\n      console.error(\"Error al entregar el ejemplar\");\n    }\n  };\n\n  return (\n    <View>\n      {detalleReserva ? (\n        <View>\n          <Text>Detalles de la reserva</Text>\n          <Text>Solicitante:{detalleReserva.owner}</Text>\n          <Text>Material: {detalleReserva.material}</Text>\n          <Text>Finalizacion: {detalleReserva.fecha_fin}</Text>\n\n          <Text>Selecciona un ejemplar: </Text>\n          <Picker\n            selectedValue={selectedEjemplar}\n            onvalueChange={(itemValue) => setSelectedEjemplar(itemValue)}\n          >\n            {ejemplaresDisponibles.map((ejemplar, index) => (\n              <Picker.Item\n                key={index}\n                label={`ID: ${ejemplar.id}, Estado: ${ejemplar.estado}`}\n                value={ejemplar.id}\n              />\n            ))}\n          </Picker>\n\n          <Button title=\"Entregar ejemplar\" onPress={handleEntregarEjemplar} />\n        </View>\n      ) : (\n        <Text>Cargando reserva...</Text>\n      )}\n    </View>\n  );\n};\n\nexport default DetalleReservaScreen;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}